<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      {{ page.title }}{% if page.title != site.title %} - {{ site.title }}{%
      endif %}
    </title>

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}"
    />
    <meta
      name="keywords"
      content="photo organizer, photo management, image organization, photo sorting, picture organizer, media management, photo library, offline photo organizer, privacy-focused, desktop app, Windows, macOS, duplicate detection, EXIF data, automatic sorting"
    />
    <meta name="author" content="{{ site.author }}" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English" />
    <meta name="revisit-after" content="7 days" />
    <meta name="distribution" content="global" />
    <meta name="rating" content="general" />

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:site_name" content="{{ site.title }}" />
    <meta
      property="og:title"
      content="{{ page.title }}{% if page.title != site.title %} - {{ site.title }}{% endif %}"
    />
    <meta
      property="og:description"
      content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ site.url }}{{ page.url }}" />
    <meta
      property="og:image"
      content="{{ site.url }}/assets/images/app-screenshot.png"
    />
    <meta
      property="og:image:alt"
      content="Photo Organizer app interface showing intelligent photo organization features"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="{{ page.title }}{% if page.title != site.title %} - {{ site.title }}{% endif %}"
    />
    <meta
      name="twitter:description"
      content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}"
    />
    <meta
      name="twitter:image"
      content="{{ site.url }}/assets/images/app-screenshot.png"
    />
    <meta
      name="twitter:image:alt"
      content="Photo Organizer app interface showing intelligent photo organization features"
    />

    <!-- App-specific Meta Tags -->
    <meta name="application-name" content="{{ site.title }}" />
    <meta name="msapplication-TileColor" content="#2563eb" />
    <meta name="theme-color" content="#2563eb" />

    <!-- Structured Data for Application -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Photo Organizer",
        "description": "{{ site.description }}",
        "applicationCategory": "MultimediaApplication",
        "operatingSystem": ["macOS 10.15+", "Windows 10", "Windows 11"],
        "offers": {
          "@type": "Offer",
          "price": "19.99",
          "priceCurrency": "EUR",
          "category": "purchase"
        },
        "downloadUrl": [
          "https://apps.apple.com/us/app/flipfocus-photo-organizer/id6743702259",
          "https://apps.microsoft.com/detail/9N0T4WCLMJ63"
        ],
        "softwareVersion": "1.0",
        "datePublished": "2025-01-01",
        "author": {
          "@type": "Person",
          "name": "{{ site.author }}",
          "affiliation": {
            "@type": "Organization",
            "name": "Mcvanhassel Web Development",
            "url": "https://mcvanhassel.com"
          }
        },
        "publisher": {
          "@type": "Organization",
          "name": "Mcvanhassel Web Development",
          "url": "https://mcvanhassel.com"
        },
        "screenshot": "{{ site.url }}/assets/images/app-screenshot.png",
        "featureList": [
          "Automatic photo and video sorting",
          "Intelligent duplicate detection",
          "EXIF data extraction and organization",
          "Privacy-focused offline operation",
          "Customizable organization structure",
          "Cross-platform support"
        ],
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "reviewCount": "127"
        }
      }
    </script>

    <!-- FAQ Structured Data for Featured Snippets -->
    {% if page.url == "/" or page.url == "/index.html" %}
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "How does Photo Organizer protect my privacy?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Photo Organizer operates 100% offline. All file processing happens locally on your device, and your photos never leave your computer. We don't collect any personal data or usage analytics."
            }
          },
          {
            "@type": "Question",
            "name": "What file formats are supported?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Photo Organizer supports all major photo formats (JPEG, PNG, HEIC, RAW files) and video formats (MP4, MOV, AVI). The app reads EXIF metadata to intelligently organize your files."
            }
          },
          {
            "@type": "Question",
            "name": "Can I undo organization changes?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Yes! Photo Organizer offers both copy and move modes. We recommend using copy mode first to test the organization structure before committing to moving files."
            }
          },
          {
            "@type": "Question",
            "name": "How does duplicate detection work?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "The app uses advanced hash algorithms to identify duplicate files, even if they have different names or are in different folders. You can choose to keep, delete, or move duplicates."
            }
          },
          {
            "@type": "Question",
            "name": "Is there a limit to how many photos I can organize?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "There's no artificial limit, but performance depends on your system resources. For optimal performance, we recommend processing fewer than 5,000 files at once for large collections."
            }
          }
        ]
      }
    </script>
    {% endif %}

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ site.url }}{{ page.url }}" />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{{ site.baseurl }}/assets/favicon/favicon32.png"
    />
    <link
      rel="manifest"
      href="{{ site.baseurl }}/assets/favicon/site.webmanifest"
    />
    <link rel="shortcut icon" href="{{ site.baseurl }}/favicon.ico" />

    <!-- CSS -->
    <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/style.css" />

    <!-- Preconnect for performance (if using external resources) -->
    <link rel="dns-prefetch" href="//apps.apple.com" />
    <link rel="dns-prefetch" href="//apps.microsoft.com" />
    <link rel="dns-prefetch" href="//github.com" />

    <!-- Google Analytics (conditionally loaded) -->
    <script>
      // GDPR Consent Management
      window.cookieConsent = {
        hasConsent: function () {
          return localStorage.getItem("ga-consent") === "granted";
        },

        setConsent: function (granted) {
          localStorage.setItem("ga-consent", granted ? "granted" : "denied");
          if (granted) {
            this.loadGoogleAnalytics();
          }
        },

        loadGoogleAnalytics: function () {
          if (this.hasConsent() && !window.gtag) {
            // Load Google Analytics
            var script = document.createElement("script");
            script.async = true;
            script.src =
              "https://www.googletagmanager.com/gtag/js?id=G-4E22ELCWM8";
            document.head.appendChild(script);

            script.onload = function () {
              window.dataLayer = window.dataLayer || [];
              function gtag() {
                dataLayer.push(arguments);
              }
              window.gtag = gtag;
              gtag("js", new Date());
              gtag("config", "G-4E22ELCWM8", {
                anonymize_ip: true,
                cookie_flags: "secure;samesite=strict",
              });
            };
          }
        },
      };

      // Load GA if consent already given
      if (window.cookieConsent.hasConsent()) {
        window.cookieConsent.loadGoogleAnalytics();
      }
    </script>

    <!-- Cookie Banner Styles -->
    <style>
      .cookie-banner {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: #1f2937;
        color: white;
        padding: 1rem;
        z-index: 1000;
        box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
        transform: translateY(100%);
        transition: transform 0.3s ease-in-out;
      }

      .cookie-banner.show {
        transform: translateY(0);
      }

      .cookie-banner-content {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
      }

      .cookie-banner-text {
        flex: 1;
        font-size: 0.875rem;
        line-height: 1.5;
      }

      .cookie-banner-actions {
        display: flex;
        gap: 0.5rem;
        flex-shrink: 0;
      }

      .cookie-btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }

      .cookie-btn-accept {
        background: #2563eb;
        color: white;
      }

      .cookie-btn-accept:hover {
        background: #1d4ed8;
      }

      .cookie-btn-decline {
        background: #6b7280;
        color: white;
      }

      .cookie-btn-decline:hover {
        background: #4b5563;
      }

      .cookie-btn-settings {
        background: transparent;
        color: #d1d5db;
        text-decoration: underline;
        border: none;
        padding: 0.5rem 0;
      }

      .cookie-btn-settings:hover {
        color: white;
      }

      @media (max-width: 768px) {
        .cookie-banner-content {
          flex-direction: column;
          text-align: center;
        }

        .cookie-banner-actions {
          width: 100%;
          justify-content: center;
          flex-wrap: wrap;
        }
      }

      /* Preference Center Modal */
      .cookie-preferences-modal {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1001;
        display: none;
        align-items: center;
        justify-content: center;
        padding: 1rem;
      }

      .cookie-preferences-content {
        background: white;
        border-radius: 0.5rem;
        padding: 2rem;
        max-width: 500px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
      }

      .cookie-preferences-modal.show {
        display: flex;
      }
    </style>
  </head>
  <body>
    <!-- Cookie Banner -->
    <div id="cookieBanner" class="cookie-banner">
      <div class="cookie-banner-content">
        <div class="cookie-banner-text">
          <strong>🍪 We value your privacy</strong><br />
          We use analytics cookies to improve our website and understand how you
          interact with our content. These cookies help us provide you with a
          better experience.
          <a
            href="{{ site.baseurl }}/privacy-policy.html"
            class="text-blue-300 hover:text-blue-200 underline"
            >Learn more in our Privacy Policy</a
          >
        </div>
        <div class="cookie-banner-actions">
          <button
            onclick="cookieConsent.accept()"
            class="cookie-btn cookie-btn-accept"
          >
            Accept All
          </button>
          <button
            onclick="cookieConsent.decline()"
            class="cookie-btn cookie-btn-decline"
          >
            Decline
          </button>
          <button
            onclick="cookieConsent.showSettings()"
            class="cookie-btn cookie-btn-settings"
          >
            Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Cookie Preferences Modal -->
    <div id="cookiePreferencesModal" class="cookie-preferences-modal">
      <div class="cookie-preferences-content">
        <h3 class="text-xl font-bold mb-4">Cookie Preferences</h3>
        <div class="space-y-4">
          <div>
            <h4 class="font-semibold mb-2">Essential Cookies</h4>
            <p class="text-sm text-gray-600 mb-2">
              These cookies are necessary for the website to function and cannot
              be disabled.
            </p>
            <label class="flex items-center">
              <input type="checkbox" checked disabled class="mr-2" />
              <span class="text-sm">Always Active</span>
            </label>
          </div>

          <div>
            <h4 class="font-semibold mb-2">Analytics Cookies</h4>
            <p class="text-sm text-gray-600 mb-2">
              Help us understand how visitors interact with our website by
              collecting anonymous information.
            </p>
            <label class="flex items-center">
              <input type="checkbox" id="analyticsConsent" class="mr-2" />
              <span class="text-sm">Google Analytics</span>
            </label>
          </div>
        </div>

        <div class="flex gap-2 mt-6">
          <button
            onclick="cookieConsent.savePreferences()"
            class="cookie-btn cookie-btn-accept flex-1"
          >
            Save Preferences
          </button>
          <button
            onclick="cookieConsent.hideSettings()"
            class="cookie-btn cookie-btn-decline"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-white shadow-sm">
      <div class="container mx-auto px-4">
        <div class="flex items-center justify-between h-16">
          <!-- Logo -->
          <a href="{{ site.baseurl }}/" class="flex items-center">
            <img
              src="{{ site.baseurl }}/assets/favicon/app.ico"
              alt="Photo Organizer - Intelligent Photo Management App Logo"
              class="w-12 h-12"
            />
            <span class="ml-2 text-xl font-semibold text-gray-900"
              >Photo Organizer</span
            >
          </a>

          <!-- Navigation Links -->
          <div class="hidden md:flex items-center space-x-8">
            <a
              href="{{ site.baseurl }}/"
              class="text-gray-600 hover:text-blue-600"
              >Home</a
            >
            <a
              href="{{ site.baseurl }}/#features"
              class="text-gray-600 hover:text-blue-600"
              >Features</a
            >
            <a
              href="{{ site.baseurl }}/#pricing"
              class="text-gray-600 hover:text-blue-600"
              >Pricing</a
            >
            <a
              href="{{ site.baseurl }}/#requirements"
              class="text-gray-600 hover:text-blue-600"
              >Requirements</a
            >
            <a
              href="{{ site.baseurl }}/#support"
              class="text-gray-600 hover:text-blue-600"
              >Support</a
            >
            <a
              href="{{ site.baseurl }}/contact.html"
              class="text-gray-600 hover:text-blue-600"
              >Contact</a
            >
          </div>

          <!-- Mobile menu button -->
          <div class="md:hidden">
            <button
              type="button"
              onclick="toggleMobileMenu()"
              class="text-gray-600 hover:text-blue-600"
              aria-label="Toggle menu"
            >
              <svg
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>

        <!-- Mobile menu -->
        <div id="mobile-menu" class="hidden md:hidden">
          <div class="px-2 pt-2 pb-3 space-y-1">
            <a
              href="{{ site.baseurl }}/"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Home</a
            >
            <a
              href="{{ site.baseurl }}/#features"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Features</a
            >
            <a
              href="{{ site.baseurl }}/#pricing"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Pricing</a
            >
            <a
              href="{{ site.baseurl }}/#requirements"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Requirements</a
            >
            <a
              href="{{ site.baseurl }}/#support"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Support</a
            >
            <a
              href="{{ site.baseurl }}/contact.html"
              class="block px-3 py-2 text-gray-600 hover:text-blue-600"
              >Contact</a
            >
          </div>
        </div>
      </div>
    </nav>

    {{ content }}

    <script>
      // Extend cookie consent functionality
      window.cookieConsent = Object.assign(window.cookieConsent || {}, {
        init: function () {
          // Show banner if no consent decision has been made
          if (!localStorage.getItem("ga-consent")) {
            setTimeout(() => {
              document.getElementById("cookieBanner").classList.add("show");
            }, 1000);
          }

          // Update analytics checkbox based on current consent
          const checkbox = document.getElementById("analyticsConsent");
          if (checkbox) {
            checkbox.checked = this.hasConsent();
          }
        },

        accept: function () {
          this.setConsent(true);
          this.hideBanner();
        },

        decline: function () {
          this.setConsent(false);
          this.hideBanner();
        },

        hideBanner: function () {
          document.getElementById("cookieBanner").classList.remove("show");
        },

        showSettings: function () {
          // Update checkbox state
          const checkbox = document.getElementById("analyticsConsent");
          if (checkbox) {
            checkbox.checked = this.hasConsent();
          }
          document
            .getElementById("cookiePreferencesModal")
            .classList.add("show");
        },

        hideSettings: function () {
          document
            .getElementById("cookiePreferencesModal")
            .classList.remove("show");
        },

        savePreferences: function () {
          const analyticsCheckbox = document.getElementById("analyticsConsent");
          const analyticsConsent = analyticsCheckbox.checked;

          this.setConsent(analyticsConsent);
          this.hideSettings();
          this.hideBanner();
        },

        // Function to show preferences (for privacy policy link)
        showPreferences: function () {
          this.showSettings();
        },
      });

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", function () {
        window.cookieConsent.init();
      });

      // Close modal when clicking outside
      document
        .getElementById("cookiePreferencesModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            window.cookieConsent.hideSettings();
          }
        });

      function toggleMobileMenu() {
        const mobileMenu = document.getElementById("mobile-menu");
        mobileMenu.classList.toggle("hidden");
      }

      // Smooth scroll for hash links
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          const target = document.querySelector(
            this.getAttribute("href").substring(1)
          );
          if (target) {
            target.scrollIntoView({
              behavior: "smooth",
            });
          }
        });
      });
    </script>
  </body>
</html>
